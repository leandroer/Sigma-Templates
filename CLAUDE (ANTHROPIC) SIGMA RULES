title: Claude Excessive API Usage
id: 77e7f8a9-b0c1-4d2e-f3a4-5b6c7d8e9f0a
status: experimental
description: Detects excessive usage of Claude/Anthropic API
references:
    - https://www.anthropic.com/
    - https://docs.anthropic.com/
author: Security Operations Team
date: 2024-01-01
modified: 2024-01-01
tags:
    - attack.exfiltration
    - attack.t1567
    - ai.claude
    - ai.anthropic
    - ai.api_abuse
logsource:
    product: windows
    category: network_connection
detection:
    selection:
        DestinationHostname|contains:
            - 'api.anthropic.com'
            - 'claude.ai'
    timeframe: 1h
    condition: selection | count(DestinationHostname) by User > 300
falsepositives:
    - High-volume production applications
    - Approved automation
level: high

---------------------------------------
title: Claude Long Context Window Abuse
id: 88f8a9b0-c1d2-4e3f-a4b5-6c7d8e9f0a1b
status: experimental
description: Detects abuse of Claude's large context window with very large prompts
references:
    - https://www.anthropic.com/news/claude-3-family
author: Security Operations Team
date: 2024-01-01
modified: 2024-01-01
tags:
    - attack.exfiltration
    - attack.t1567
    - ai.claude
    - ai.context_abuse
logsource:
    product: windows
    category: network_connection
detection:
    selection:
        DestinationHostname|contains:
            - 'api.anthropic.com'
            - 'claude.ai'
    filter_size:
        SentBytes|gte: 102400  # >100KB requests
    timeframe: 1h
    condition: selection and filter_size | count(DestinationHostname) by User > 5
falsepositives:
    - Document analysis tasks
    - Large codebase reviews
level: medium

------------------------------------------
title: Claude API Key Compromise Detection
id: 99a9b0c1-d2e3-4f4a-b5c6-7d8e9f0a1b2c
status: experimental
description: Detects potential Claude API key compromise through multi-device usage
references:
    - https://docs.anthropic.com/claude/reference/getting-started-with-the-api
author: Security Operations Team
date: 2024-01-01
modified: 2024-01-01
tags:
    - attack.credential_access
    - attack.t1552
    - ai.claude
    - ai.key_compromise
logsource:
    product: windows
    category: network_connection
detection:
    selection:
        DestinationHostname|contains: 'api.anthropic.com'
    timeframe: 1h
    condition: selection | count(distinct Device) by DestinationIP > 5
falsepositives:
    - Distributed applications
    - Development teams
level: high

-----------------------------------------
title: Claude Artifacts Data Exfiltration
id: 00b0c1d2-e3f4-4a5b-c6d7-8e9f0a1b2c3d
status: experimental
description: Detects potential data exfiltration through Claude's artifacts feature
references:
    - https://www.anthropic.com/news/claude-3-5-sonnet
author: Security Operations Team
date: 2024-01-01
modified: 2024-01-01
tags:
    - attack.exfiltration
    - attack.t1567
    - ai.claude
    - ai.artifacts_abuse
logsource:
    product: windows
    category: network_connection
detection:
    selection:
        DestinationHostname|contains: 'claude.ai'
    filter_volume:
        SentBytes|gte: 524288000  # >500MB
    condition: selection and filter_volume
falsepositives:
    - Large project work
    - Extensive code generation
level: high

------------------------------------------------
title: Claude Prompt Injection via Web Interface
id: 11c1d2e3-f4a5-4b6c-d7e8-9f0a1b2c3d4e
status: experimental
description: Detects large prompts to Claude web interface that may contain injections
references:
    - https://docs.anthropic.com/claude/docs/reducing-misuse
author: Security Operations Team
date: 2024-01-01
modified: 2024-01-01
tags:
    - attack.initial_access
    - attack.t1190
    - ai.claude
    - ai.prompt_injection
logsource:
    product: windows
    category: network_connection
detection:
    selection:
        DestinationHostname|contains: 'claude.ai'
        InitiatingProcessName|endswith:
            - 'chrome.exe'
            - 'firefox.exe'
            - 'msedge.exe'
            - 'brave.exe'
    filter_size:
        SentBytes|gte: 51200  # >50KB
    timeframe: 1h
    condition: selection and filter_size | count(DestinationHostname) by User > 10
falsepositives:
    - Document analysis
    - Large code reviews
level: medium
